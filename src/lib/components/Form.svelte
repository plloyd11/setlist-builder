<script>
	import { setlist } from '$lib/store.js';
	let title = '';
	let duration = '';

	const addSong = () => {
		const durationParts = duration.split(':');
		if (
			durationParts.length !== 2 ||
			isNaN(durationParts[0]) ||
			isNaN(durationParts[1]) ||
			Number(durationParts[1]) > 59
		) {
			alert('Duration must be in mm:ss format');
			return;
		}

		const [minutes, seconds] = durationParts.map(Number);
		const totalDuration = minutes * 60 + seconds;
		setlist.update((songs) => [...songs, { title, duration: totalDuration }]);
		title = '';
		duration = '';
	};
</script>

<section class="max-w-4xl mx-auto">
	<form on:submit|preventDefault={addSong} class="space-y-8">
		<div class="grid grid-cols-2 gap-8">
			<label class="label">
				Song title
				<input class="input" type="text" bind:value={title} required />
			</label>
			<label class="label">
				Song duration
				<input
					class="input"
					type="text"
					bind:value={duration}
					required
					placeholder="mm:ss format"
				/>
			</label>
		</div>
		<button type="submit" class="btn variant-filled-primary">
			<span>Add Song</span>
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-6 h-6">
				<path
					d="M19.5 10.49c-.01-4.15-3.36-7.5-7.51-7.5s-7.5 3.35-7.5 7.5c0 2.5 1.25 4.84 3.33 6.23l-.34-.63v2.63c0 1.24 1 2.25 2.25 2.25h4.5c1.24 0 2.25-1.01 2.25-2.25v-2.64l-.34.62c2.08-1.4 3.33-3.74 3.33-6.24Zm-1.5 0c0 2-1 3.87-2.67 4.98-.21.13-.34.37-.34.62v2.63c0 .41-.34.75-.75.75h-4.5c-.42 0-.75-.34-.75-.75v-2.64c0-.26-.13-.49-.34-.63-1.67-1.12-2.67-2.99-2.67-4.99-.01-3.32 2.68-6.01 5.99-6.01 3.31-.01 6 2.68 6 5.99Z"
				/>
				<path
					d="M8.46 10.65c.29.29.76.29 1.06 0 .29-.3.29-.77 0-1.07-.3-.3-.77-.3-1.07 0-.3.29-.3.76 0 1.06Z"
				/>
				<path
					d="M9 9.37c-.63 0-1.13.5-1.13 1.125 0 .62.5 1.125 1.12 1.125.62 0 1.125-.51 1.125-1.125 0-.62-.51-1.13-1.13-1.13-.01-.01-.01-.01-.01 0-.42 0-.75.33-.75.75 0 .41.33.74.75.74h-.01c-.21-.01-.38-.17-.38-.38-.01-.21.16-.38.37-.38.2 0 .375.16.375.375 0 .2-.17.375-.375.375.41 0 .75-.34.75-.75 0-.42-.34-.75-.75-.75Zm5.46 1.28c.29.29.76.29 1.06 0 .29-.3.29-.77 0-1.07-.3-.3-.77-.3-1.07 0-.3.29-.3.76 0 1.06Z"
				/>
				<path
					d="M15 9.37c-.63 0-1.125.5-1.125 1.125 0 .62.5 1.125 1.125 1.125.62 0 1.125-.51 1.125-1.125 0-.62-.51-1.13-1.13-1.13-.01-.01-.01-.01-.01 0-.42 0-.75.33-.75.75 0 .41.33.74.75.74h-.01c-.21-.01-.38-.17-.38-.38-.01-.21.16-.38.37-.38.2 0 .375.16.375.375 0 .2-.17.375-.375.375.41 0 .75-.34.75-.75 0-.42-.34-.75-.75-.75ZM4.5 3c0 .82-.68 1.5-1.5 1.5-.83 0-1.5-.68-1.5-1.5 0-.83.67-1.5 1.5-1.5.82 0 1.5.67 1.5 1.5ZM6 3c0-1.66-1.35-3-3-3-1.66 0-3 1.34-3 3 0 1.65 1.34 3 3 3 1.65 0 3-1.35 3-3Zm16.5 0c0 .82-.68 1.5-1.5 1.5-.83 0-1.5-.68-1.5-1.5 0-.83.67-1.5 1.5-1.5.82 0 1.5.67 1.5 1.5ZM24 3c0-1.66-1.35-3-3-3-1.66 0-3 1.34-3 3 0 1.65 1.34 3 3 3 1.65 0 3-1.35 3-3ZM4.5 21c0 .82-.68 1.5-1.5 1.5-.83 0-1.5-.68-1.5-1.5 0-.83.67-1.5 1.5-1.5.82 0 1.5.67 1.5 1.5ZM6 21c0-1.66-1.35-3-3-3-1.66 0-3 1.34-3 3 0 1.65 1.34 3 3 3 1.65 0 3-1.35 3-3Zm16.5 0c0 .82-.68 1.5-1.5 1.5-.83 0-1.5-.68-1.5-1.5 0-.83.67-1.5 1.5-1.5.82 0 1.5.67 1.5 1.5Zm1.5 0c0-1.66-1.35-3-3-3-1.66 0-3 1.34-3 3 0 1.65 1.34 3 3 3 1.65 0 3-1.35 3-3Z"
				/>
				<path
					d="m7.5 15.42-3.45 3.45c-.3.29-.3.76 0 1.06.29.29.76.29 1.06 0l3.45-3.45c.29-.3.29-.77 0-1.07-.3-.3-.77-.3-1.07 0ZM18.87 4.05 16.92 6c-.3.29-.3.76 0 1.06.29.29.76.29 1.06 0l1.95-1.95c.29-.3.29-.77 0-1.07-.3-.3-.77-.3-1.07-.001Zm-3.45 12.44 3.45 3.45c.29.29.76.29 1.06 0 .29-.3.29-.77 0-1.07l-3.45-3.45c-.3-.3-.77-.3-1.07 0-.3.29-.3.76 0 1.06ZM4.05 5.12 6 7.07c.29.29.76.29 1.06 0 .29-.3.29-.77 0-1.07L5.11 4.05c-.3-.3-.77-.3-1.07 0-.3.29-.3.76 0 1.06Z"
				/>
			</svg>
		</button>
	</form>
</section>
